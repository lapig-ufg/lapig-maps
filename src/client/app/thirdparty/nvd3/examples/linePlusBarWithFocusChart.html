<!DOCTYPE html>
<meta charset="utf-8">

<link href="../src/nv.d3.css" rel="stylesheet" type="text/css">

<style>

body {
  overflow-y:scroll;
}

text {
  font: 12px sans-serif;
}

#chart1 svg {
  height: 500px;
  margin: 10px;
  min-width: 100px;
  min-height: 100px;
/*
  Minimum height and width is a good idea to prevent negative SVG dimensions...
  For example width should be =< margin.left + margin.right + 1,
  of course 1 pixel for the entire chart would not be very useful, BUT should not have errors
*/
}

</style>
<body>

  <div id="chart1" class='with-3d-shadow with-transitions'>
    <svg> </svg>
  </div>

<script src="../lib/d3.v3.js"></script>
<script src="../nv.d3.js"></script>
<script src="../src/utils.js"></script>
<script src="../src/tooltip.js"></script>
<script src="../src/models/legend.js"></script>
<script src="../src/models/axis.js"></script>
<script src="../src/models/scatter.js"></script>
<script src="../src/models/line.js"></script>
<script src="../src/models/historicalBar.js"></script>
<script src="../src/models/linePlusBarWithFocusChart.js"></script>
<script>


var testdata = [
{
  name: "EWT",
  key: "Variação Gravimétrica da Água (GRACE)",
  values: [
    [
    1041386400000,
    -5.58173322678
    ],
    [
    1044064800000,
    4.59187650681
    ],
    [
    1046487600000,
    3.94929289818
    ],
    [
    1049166000000,
    2.62153697014
    ],
    [
    1051758000000,
    3.46461176872
    ],
    [
    1057028400000,
    -6.94265699387
    ],
    [
    1059706800000,
    -13.788476944
    ],
    [
    1062385200000,
    -14.8101987839
    ],
    [
    1064977200000,
    -14.5933322906
    ],
    [
    1067652000000,
    -11.3085737228
    ],
    [
    1070244000000,
    -11.7330751419
    ],
    [
    1072922400000,
    -8.99405479431
    ],
    [
    1075600800000,
    16.7217388153
    ],
    [
    1078110000000,
    18.3976459503
    ],
    [
    1080788400000,
    20.6960868835
    ],
    [
    1083380400000,
    16.2412452698
    ],
    [
    1086058800000,
    6.49730396271
    ],
    [
    1088650800000,
    -0.188392192125
    ],
    [
    1091329200000,
    -2.83779382706
    ],
    [
    1094007600000,
    -6.65769338608
    ],
    [
    1096599600000,
    -7.78412055969
    ],
    [
    1099278000000,
    -9.76756477356
    ],
    [
    1101866400000,
    -1.04559755325
    ],
    [
    1104544800000,
    2.00376772881
    ],
    [
    1107223200000,
    5.13141107559
    ],
    [
    1109646000000,
    11.2464323044
    ],
    [
    1112324400000,
    13.1594743729
    ],
    [
    1114916400000,
    13.1050949097
    ],
    [
    1117594800000,
    3.30959939957
    ],
    [
    1120186800000,
    -1.26317191124
    ],
    [
    1122865200000,
    -1.94705498219
    ],
    [
    1125543600000,
    -5.27416229248
    ],
    [
    1128135600000,
    -4.7040104866
    ],
    [
    1130810400000,
    -7.38376998901
    ],
    [
    1133402400000,
    1.16847491264
    ],
    [
    1136080800000,
    3.29762434959
    ],
    [
    1138759200000,
    4.05452728271
    ],
    [
    1141182000000,
    8.14508914948
    ],
    [
    1143860400000,
    21.758852005
    ],
    [
    1146452400000,
    14.9166040421
    ],
    [
    1149130800000,
    11.302570343
    ],
    [
    1151722800000,
    4.60364770889
    ],
    [
    1154401200000,
    -3.15800142288
    ],
    [
    1157079600000,
    -7.26582193375
    ],
    [
    1159671600000,
    -5.92524957657
    ],
    [
    1162350000000,
    1.15120911598
    ],
    [
    1164938400000,
    2.28724074364
    ],
    [
    1167616800000,
    0.677710235119
    ],
    [
    1170295200000,
    15.6245918274
    ],
    [
    1172718000000,
    16.2213668823
    ],
    [
    1175396400000,
    9.02138137817
    ],
    [
    1177988400000,
    3.80885267258
    ],
    [
    1180666800000,
    -1.50159406662
    ],
    [
    1183258800000,
    -7.69445610046
    ],
    [
    1185937200000,
    -7.96483898163
    ],
    [
    1188615600000,
    -10.3686065674
    ],
    [
    1191207600000,
    -14.6236658096
    ],
    [
    1193882400000,
    -16.0599746704
    ],
    [
    1196474400000,
    -6.8412861824
    ],
    [
    1199152800000,
    -7.01206445694
    ],
    [
    1201831200000,
    -5.11229372025
    ],
    [
    1204340400000,
    3.8942592144
    ],
    [
    1207018800000,
    8.18144416809
    ],
    [
    1209610800000,
    5.06352519989
    ],
    [
    1212289200000,
    -5.93109273911
    ],
    [
    1214881200000,
    -7.64038276672
    ],
    [
    1217559600000,
    -11.0295724869
    ],
    [
    1220238000000,
    -14.9120693207
    ],
    [
    1222830000000,
    -18.6652431488
    ],
    [
    1225504800000,
    -11.7986927032
    ],
    [
    1228096800000,
    -8.00955200195
    ],
    [
    1230775200000,
    -3.04787564278
    ],
    [
    1233453600000,
    -1.75539267063
    ],
    [
    1235876400000,
    -0.65057516098
    ],
    [
    1238554800000,
    8.68941497803
    ],
    [
    1241146800000,
    11.3021640778
    ],
    [
    1243825200000,
    4.67445707321
    ],
    [
    1246417200000,
    -0.673820495605
    ],
    [
    1249095600000,
    -6.19467067719
    ],
    [
    1251774000000,
    -9.08740139008
    ],
    [
    1254366000000,
    -9.08436584473
    ],
    [
    1257040800000,
    1.48718631268
    ],
    [
    1259632800000,
    -1.85164821148
    ],
    [
    1262311200000,
    3.78535699844
    ],
    [
    1264989600000,
    2.28148388863
    ],
    [
    1267412400000,
    6.41917943954
    ],
    [
    1270090800000,
    7.22758197784
    ],
    [
    1272682800000,
    0.72008150816
    ],
    [
    1275361200000,
    -2.36363506317
    ],
    [
    1277953200000,
    -3.46437382698
    ],
    [
    1280631600000,
    -7.65756177902
    ],
    [
    1283310000000,
    -15.6463308334
    ],
    [
    1285902000000,
    -15.296081543
    ],
    [
    1288576800000,
    -10.0518903732
    ],
    [
    1291168800000,
    -3.1729722023
    ],
    [
    1296525600000,
    5.16806411743
    ],
    [
    1298948400000,
    9.92409610748
    ],
    [
    1301626800000,
    12.2477865219
    ],
    [
    1304218800000,
    7.33167791367
    ],
    [
    1309489200000,
    -5.30130672455
    ],
    [
    1312167600000,
    -8.37130069733
    ],
    [
    1314846000000,
    -7.7404551506
    ],
    [
    1317438000000,
    -10.3306398392
    ],
    [
    1320112800000,
    -7.53955078125
    ],
    [
    1322704800000,
    1.5122345686
    ],
    [
    1325383200000,
    3.87012171745
    ],
    [
    1328061600000,
    5.77563714981
    ],
    [
    1330570800000,
    7.09305429459
    ],
    [
    1333249200000,
    4.89682769775
    ],
    [
    1338519600000,
    -5.56119155884
    ],
    [
    1341111600000,
    -10.9715709686
    ],
    [
    1343790000000,
    -15.3704853058
    ],
    [
    1346468400000,
    -12.4072523117
    ],
    [
    1351735200000,
    -9.90795040131
    ],
    [
    1354327200000,
    -9.47520828247
    ]
  ]
},
{
  name: "PRECIPITATION",
  key: "Precipitação (TRMM)",
  values: [
    [
    946692000000,
    91.8658370972
    ],
    [
    949370400000,
    211.156280518
    ],
    [
    951879600000,
    113.771972656
    ],
    [
    954558000000,
    67.6837081909
    ],
    [
    957150000000,
    8.0170173645
    ],
    [
    959828400000,
    1.80432200432
    ],
    [
    962420400000,
    0.900755763054
    ],
    [
    965098800000,
    0.590474069118
    ],
    [
    967777200000,
    43.3943023682
    ],
    [
    970369200000,
    22.6233596802
    ],
    [
    973044000000,
    231.019454956
    ],
    [
    975636000000,
    278.693511963
    ],
    [
    978314400000,
    43.9099273682
    ],
    [
    980992800000,
    69.6689147949
    ],
    [
    983415600000,
    152.73576355
    ],
    [
    986094000000,
    53.4146461487
    ],
    [
    988686000000,
    19.6936168671
    ],
    [
    991364400000,
    1.52046310902
    ],
    [
    993956400000,
    0
    ],
    [
    996634800000,
    0.982726752758
    ],
    [
    999313200000,
    0.251769959927
    ],
    [
    1001905200000,
    77.3156661987
    ],
    [
    1004580000000,
    113.543113708
    ],
    [
    1007172000000,
    126.214576721
    ],
    [
    1009850400000,
    348.784606934
    ],
    [
    1012528800000,
    90.6282272339
    ],
    [
    1014951600000,
    24.9560718536
    ],
    [
    1017630000000,
    84.9976196289
    ],
    [
    1020222000000,
    10.3786182404
    ],
    [
    1022900400000,
    1.71081316471
    ],
    [
    1025492400000,
    0
    ],
    [
    1028170800000,
    3.63250994682
    ],
    [
    1030849200000,
    64.8678436279
    ],
    [
    1033441200000,
    1.27103674412
    ],
    [
    1036119600000,
    119.987190247
    ],
    [
    1038708000000,
    126.726097107
    ],
    [
    1041386400000,
    154.4506073
    ],
    [
    1044064800000,
    49.8847084045
    ],
    [
    1046487600000,
    154.656478882
    ],
    [
    1049166000000,
    22.8075504303
    ],
    [
    1051758000000,
    49.5210075378
    ],
    [
    1054436400000,
    1.97040176392
    ],
    [
    1057028400000,
    1.47707641125
    ],
    [
    1059706800000,
    11.7010583878
    ],
    [
    1062385200000,
    0.922596156597
    ],
    [
    1064977200000,
    5.74170255661
    ],
    [
    1067652000000,
    52.7010726929
    ],
    [
    1070244000000,
    45.8533248901
    ],
    [
    1072922400000,
    429.450775146
    ],
    [
    1075600800000,
    162.925247192
    ],
    [
    1078110000000,
    134.972503662
    ],
    [
    1080788400000,
    25.7844352722
    ],
    [
    1083380400000,
    3.51260995865
    ],
    [
    1086058800000,
    0.219460979104
    ],
    [
    1088650800000,
    0
    ],
    [
    1091329200000,
    0.390896588564
    ],
    [
    1094007600000,
    0.637104332447
    ],
    [
    1096599600000,
    36.8910484314
    ],
    [
    1099278000000,
    104.982421875
    ],
    [
    1101866400000,
    56.8906173706
    ],
    [
    1104544800000,
    142.666091919
    ],
    [
    1107223200000,
    176.704177856
    ],
    [
    1109646000000,
    150.274215698
    ],
    [
    1112324400000,
    132.255157471
    ],
    [
    1114916400000,
    44.7030715942
    ],
    [
    1117594800000,
    3.07029485703
    ],
    [
    1120186800000,
    1.69246423244
    ],
    [
    1122865200000,
    3.21434521675
    ],
    [
    1125543600000,
    19.0250205994
    ],
    [
    1128135600000,
    1.45434331894
    ],
    [
    1130810400000,
    108.143310547
    ],
    [
    1133402400000,
    114.292022705
    ],
    [
    1136080800000,
    8.60916233063
    ],
    [
    1138759200000,
    125.91078949
    ],
    [
    1141182000000,
    275.306518555
    ],
    [
    1143860400000,
    235.382720947
    ],
    [
    1146452400000,
    18.135509491
    ],
    [
    1149130800000,
    3.18044352531
    ],
    [
    1151722800000,
    0
    ],
    [
    1154401200000,
    0.273518115282
    ],
    [
    1157079600000,
    1.61897671223
    ],
    [
    1159671600000,
    92.0497512817
    ],
    [
    1162350000000,
    116.580337524
    ],
    [
    1164938400000,
    101.010246277
    ],
    [
    1167616800000,
    47.9536514282
    ],
    [
    1170295200000,
    352.647888184
    ],
    [
    1172718000000,
    38.5201759338
    ],
    [
    1175396400000,
    25.6459541321
    ],
    [
    1177988400000,
    10.8167448044
    ],
    [
    1180666800000,
    2.01991939545
    ],
    [
    1183258800000,
    0
    ],
    [
    1185937200000,
    0.301987230778
    ],
    [
    1188615600000,
    2.86623740196
    ],
    [
    1191207600000,
    0.183146417141
    ],
    [
    1193882400000,
    159.838439941
    ],
    [
    1196474400000,
    84.9920272827
    ],
    [
    1199152800000,
    67.3916320801
    ],
    [
    1201831200000,
    208.840866089
    ],
    [
    1204340400000,
    131.019760132
    ],
    [
    1207018800000,
    134.702026367
    ],
    [
    1209610800000,
    3.76385736465
    ],
    [
    1212289200000,
    0.874277412891
    ],
    [
    1214881200000,
    0
    ],
    [
    1217559600000,
    0.404585987329
    ],
    [
    1220238000000,
    2.66933917999
    ],
    [
    1222830000000,
    0
    ],
    [
    1225504800000,
    65.8760986328
    ],
    [
    1228096800000,
    225.138961792
    ],
    [
    1230775200000,
    94.4026489258
    ],
    [
    1233453600000,
    203.591842651
    ],
    [
    1235876400000,
    194.851669312
    ],
    [
    1238554800000,
    172.461593628
    ],
    [
    1241146800000,
    28.6943397522
    ],
    [
    1243825200000,
    21.2230510712
    ],
    [
    1246417200000,
    1.53498625755
    ],
    [
    1249095600000,
    0.19897697866
    ],
    [
    1251774000000,
    1.15181624889
    ],
    [
    1254366000000,
    173.20249939
    ],
    [
    1257040800000,
    19.6143417358
    ],
    [
    1259632800000,
    135.210006714
    ],
    [
    1262311200000,
    110.210380554
    ],
    [
    1264989600000,
    64.187171936
    ],
    [
    1267412400000,
    165.97277832
    ],
    [
    1270090800000,
    169.777420044
    ],
    [
    1272682800000,
    3.5995156765
    ],
    [
    1275361200000,
    0.435876011848
    ],
    [
    1277953200000,
    8.09037017822
    ],
    [
    1280631600000,
    2.72423481941
    ],
    [
    1283310000000,
    1.17621827126
    ],
    [
    1285902000000,
    42.2979431152
    ],
    [
    1288576800000,
    126.872154236
    ],
    [
    1291168800000,
    171.090454102
    ],
    [
    1293847200000,
    81.2007293701
    ],
    [
    1296525600000,
    225.625106812
    ],
    [
    1298948400000,
    286.190460205
    ],
    [
    1301626800000,
    82.3064498901
    ],
    [
    1304218800000,
    3.7107167244
    ],
    [
    1306897200000,
    7.3635187149
    ],
    [
    1309489200000,
    0.516225218773
    ],
    [
    1312167600000,
    1.15368640423
    ],
    [
    1314846000000,
    1.17621827126
    ],
    [
    1317438000000,
    42.2979431152
    ],
    [
    1320112800000,
    89.6825790405
    ],
    [
    1322704800000,
    82.1199951172
    ],
    [
    1343790000000,
    2.30209302902
    ],
    [
    1346468400000,
    0.928122997284
    ],
    [
    1349060400000,
    5.27453994751
    ],
    [
    1351735200000,
    155.42010498
    ],
    [
    1354327200000,
    38.3936042786
    ],
    [
    1325383200000,
    40.468963623
    ],
    [
    1328061600000,
    71.4232177734
    ],
    [
    1330570800000,
    68.7348251343
    ],
    [
    1333249200000,
    9.65606880188
    ],
    [
    1335841200000,
    5.79196214676
    ],
    [
    1338519600000,
    0.161077588797
    ],
    [
    1341111600000,
    0.598330497742
    ],
    [
    1357005600000,
    249.837051392
    ],
    [
    1359684000000,
    28.0582752228
    ],
    [
    1362106800000,
    52.7529029846
    ],
    [
    1364785200000,
    108.395820618
    ],
    [
    1367377200000,
    2.16950488091
    ],
    [
    1370055600000,
    1.32289993763
    ],
    [
    1372647600000,
    2.56591939926
    ],
    [
    1375326000000,
    1.61784565449
    ],
    [
    1378004400000,
    0.852923750877
    ]
  ],
  bar: true
}
].map(function(series) {
  series.values = series.values.map(function(d) { return {x: d[0], y: d[1] } });
  return series;
});


/*
//For testing single data point
var testdata = [
  {
    "key" : "Quantity" ,
    "bar": true,
    "values" : [ [ 1136005200000 , 1271000.0] ]
  } ,
  {
    "key" : "Price" ,
    "values" : [ [ 1136005200000 , 71.89] ]
  }
].map(function(series) {
  series.values = series.values.map(function(d) { return {x: d[0], y: d[1] } });
  return series;
});
*/



nv.addGraph(function() {
    var chart = nv.models.linePlusBarWithFocusChart()
        .margin({top: 30, right: 60, bottom: 50, left: 70})
        .x(function(d,i) { return i })
        .color(d3.scale.category10().range());

    chart.xAxis.tickFormat(function(d) {

      var dx = testdata[0].values[d] && testdata[0].values[d].x || 0;
      if (dx > 0) {
          return d3.time.format('%m/%Y')(new Date(dx))
      }
      return null;
    });

    chart.x2Axis.tickFormat(function(d) {
      var dx = testdata[0].values[d] && testdata[0].values[d].x || 0;
      return d3.time.format('%m/%Y')(new Date(dx))
    });
    
    chart.y1Axis
        .tickFormat(d3.format(',f'));

    chart.y3Axis
        .tickFormat(d3.format(',f'));
        
    chart.y2Axis
        .tickFormat(function(d) { return '' + d3.format(',.2f')(d) });

    chart.y4Axis
        .tickFormat(function(d) { return '' + d3.format(',.2f')(d) });
        
    chart.bars.forceY([0]);
    chart.bars2.forceY([0]);
    //chart.lines.forceY([0]);
    nv.log(testdata);
    d3.select('#chart1 svg')
        .datum(testdata)
        .call(chart);

//    nv.utils.windowResize(chart.update);

    return chart;
});

</script>
